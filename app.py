# -*- coding: utf-8 -*-
"""app.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12YHG62azQ9FYB_0bvBHdYl2A5gHvLqMO

# 1. Installing Streamlit
"""

!pip install streamlit

"""# 2. Basic App Skeleton"""

import streamlit as st
import pandas as pd
import numpy as np
import pickle

"""# 3. Loading the Artifacts"""

with open("attrition_model.pkl", "rb") as f:
    model = pickle.load(f)

with open("scaler.pkl", "rb") as f:
    scaler = pickle.load(f)

with open("feature_columns.pkl", "rb") as f:
    feature_columns = pickle.load(f)

"""# 4. App Title & Description"""

st.set_page_config(page_title="Employee Attrition Predictor", layout="centered")

st.title("Employee Attrition Prediction App")
st.write(
    "This app predicts the probability of an employee leaving the company "
    "based on job, satisfaction, and work-related factors."
)

"""# 5. User Input Form"""

def user_input_features():
    Age = st.slider("Age", 18, 60, 30)
    MonthlyIncome = st.slider("Monthly Income", 1000, 20000, 5000)
    DistanceFromHome = st.slider("Distance From Home", 1, 30, 10)
    TotalWorkingYears = st.slider("Total Working Years", 0, 40, 10)
    YearsAtCompany = st.slider("Years At Company", 0, 40, 5)
    YearsSinceLastPromotion = st.slider("Years Since Last Promotion", 0, 15, 2)
    JobSatisfaction = st.selectbox("Job Satisfaction", [1, 2, 3, 4])
    EnvironmentSatisfaction = st.selectbox("Environment Satisfaction", [1, 2, 3, 4])
    JobInvolvement = st.selectbox("Job Involvement", [1, 2, 3, 4])
    OverTime = st.selectbox("OverTime", ["Yes", "No"])

    data = {
        "Age": Age,
        "MonthlyIncome": MonthlyIncome,
        "DistanceFromHome": DistanceFromHome,
        "TotalWorkingYears": TotalWorkingYears,
        "YearsAtCompany": YearsAtCompany,
        "YearsSinceLastPromotion": YearsSinceLastPromotion,
        "JobSatisfaction": JobSatisfaction,
        "EnvironmentSatisfaction": EnvironmentSatisfaction,
        "JobInvolvement": JobInvolvement,
        "OverTime_Yes": 1 if OverTime == "Yes" else 0
    }

    return pd.DataFrame([data])

"""# 6. Aligning Input with Training Features"""

input_df = user_input_features()

# Add missing columns
for col in feature_columns:
    if col not in input_df.columns:
        input_df[col] = 0

# Reorder columns
input_df = input_df[feature_columns]

# Scale input
input_scaled = scaler.transform(input_df)

"""# 7. Prediction & Output"""

if st.button("Predict Attrition Risk"):
    prob = model.predict_proba(input_scaled)[0][1]

    st.subheader("Prediction Result")

    if prob > 0.6:
        st.error(f"High Attrition Risk (Probability: {prob:.2f})")
    elif prob > 0.3:
        st.warning(f"Medium Attrition Risk (Probability: {prob:.2f})")
    else:
        st.success(f"Low Attrition Risk (Probability: {prob:.2f})")

